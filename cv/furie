–ß—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏?
–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ ‚Äì —ç—Ç–æ –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–ª–æ–∂–∏—Ç—å —Å–ª–æ–∂–Ω—ã–π —Å–∏–≥–Ω–∞–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–ª–∏ –∑–≤—É–∫) –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ —Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω—ã–µ –≤–æ–ª–Ω—ã. –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —É —Ç–µ–±—è –µ—Å—Ç—å –∞–∫–∫–æ—Ä–¥ –Ω–∞ –≥–∏—Ç–∞—Ä–µ ‚Äì –æ–Ω —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–æ—Ç. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ ‚Äì —ç—Ç–æ —Å–ø–æ—Å–æ–± —É–∑–Ω–∞—Ç—å, –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –Ω–æ—Ç—ã (—á–∞—Å—Ç–æ—Ç—ã) –≤—Ö–æ–¥—è—Ç –≤ —ç—Ç–æ—Ç –∞–∫–∫–æ—Ä–¥ –∏ —Å –∫–∞–∫–æ–π –≥—Ä–æ–º–∫–æ—Å—Ç—å—é –æ–Ω–∏ –∑–≤—É—á–∞—Ç.

–í –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–º –∑—Ä–µ–Ω–∏–∏ (CV) –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä:
–£–¥–∞–ª–µ–Ω–∏–µ —à—É–º–∞
–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫—Ä–∞–µ–≤
–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–∑–∫–æ—Å—Ç–∏
–ö–æ–º–ø—Ä–µ—Å—Å–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–∫–∞–∫ –≤ JPEG)

–ö–∞–∫ —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏?
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Äì —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ —á–∏—Å–µ–ª (–≥–¥–µ –∫–∞–∂–¥—ã–π –ø–∏–∫—Å–µ–ª—å –∏–º–µ–µ—Ç —è—Ä–∫–æ—Å—Ç—å). –ú—ã –º–æ–∂–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —ç—Ç–æ –∫–∞–∫ —Å—É–º–º—É –≤–æ–ª–Ω (–∫–∞–∫ –≤ –º—É–∑—ã–∫–µ). –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏.


–í –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–º –∑—Ä–µ–Ω–∏–∏ –º—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –î–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ (DFT) –∏ –µ–≥–æ –±—ã—Å—Ç—Ä—É—é –≤–µ—Ä—Å–∏—é –ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ (FFT).


1. –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ –≤ Python (–Ω–∞ –ø—Ä–∏–º–µ—Ä–µ OpenCV)?
–î–∞–≤–∞–π —Å—Ä–∞–∑—É –ø–µ—Ä–µ–π–¥–µ–º –∫ –ø—Ä–∞–∫—Ç–∏–∫–µ.
–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –§—É—Ä—å–µ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é

import cv2
import numpy as np
import matplotlib.pyplot as plt

# –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –≥—Ä–∞–¥–∞—Ü–∏—è—Ö —Å–µ—Ä–æ–≥–æ
image = cv2.imread('image.jpg', 0)

# –ü—Ä–∏–º–µ–Ω—è–µ–º –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ (DFT)
f_transform = np.fft.fft2(image)  # –ü—Ä—è–º–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ
f_shift = np.fft.fftshift(f_transform)  # –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –Ω–∏–∑–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã

# –í—ã—á–∏—Å–ª—è–µ–º –∞–º–ø–ª–∏—Ç—É–¥–Ω—ã–π —Å–ø–µ–∫—Ç—Ä
magnitude_spectrum = 20 * np.log(np.abs(f_shift))

# –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –µ–≥–æ —Å–ø–µ–∫—Ç—Ä
plt.figure(figsize=(10, 5))
plt.subplot(1, 2, 1)
plt.imshow(image, cmap='gray')
plt.title('–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ')

plt.subplot(1, 2, 2)
plt.imshow(magnitude_spectrum, cmap='gray')
plt.title('–°–ø–µ–∫—Ç—Ä –§—É—Ä—å–µ')
plt.show()

üîπ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥?
–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —á–µ—Ä–Ω–æ-–±–µ–ª–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.
–ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ (np.fft.fft2), —á—Ç–æ–±—ã —Ä–∞–∑–ª–æ–∂–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ —á–∞—Å—Ç–æ—Ç—ã.
–°–¥–≤–∏–≥–∞–µ—Ç —Ü–µ–Ω—Ç—Ä —á–∞—Å—Ç–æ—Ç–Ω–æ–≥–æ —Å–ø–µ–∫—Ç—Ä–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω—É (np.fft.fftshift).
–°—Ç—Ä–æ–∏—Ç —Å–ø–µ–∫—Ç—Ä —á–∞—Å—Ç–æ—Ç, –ø–æ–∫–∞–∑—ã–≤–∞—è, –∫–∞–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç.

üîπ –ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç?

–í —Ü–µ–Ω—Ç—Ä–µ —Å–ø–µ–∫—Ç—Ä–∞ –§—É—Ä—å–µ ‚Äì –Ω–∏–∑–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã (–æ–±—â–∏–µ —Ñ–æ—Ä–º—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è).
–ü–æ –∫—Ä–∞—è–º ‚Äì –≤—ã—Å–æ–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã (–¥–µ—Ç–∞–ª–∏, —Ç–µ–∫—Å—Ç—É—Ä—ã, —à—É–º).



2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —à—É–º–∞ —Å –ø–æ–º–æ—â—å—é –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –§—É—Ä—å–µ
–ò–Ω–æ–≥–¥–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —à—É–º, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–≤ –≤—ã—Å–æ–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã.

–§–∏–ª—å—Ç—Ä –Ω–∏–∑–∫–∏—Ö —á–∞—Å—Ç–æ—Ç (—É–±–∏—Ä–∞–µ–º –¥–µ—Ç–∞–ª–∏, –æ—Å—Ç–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–æ—Ä–º—ã)

rows, cols = image.shape
crow, ccol = rows // 2, cols // 2  # –¶–µ–Ω—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

# –°–æ–∑–¥–∞–µ–º –º–∞—Å–∫—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∏–∑–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã
mask = np.zeros((rows, cols), np.uint8)
mask[crow-30:crow+30, ccol-30:ccol+30] = 1  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ç–æ–ª—å–∫–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—É—é —á–∞—Å—Ç—å —Å–ø–µ–∫—Ç—Ä–∞

# –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∞—Å–∫—É –∫ —á–∞—Å—Ç–æ—Ç–Ω–æ–º—É —Å–ø–µ–∫—Ç—Ä—É
f_shift_filtered = f_shift * mask

# –û–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ
f_ishift = np.fft.ifftshift(f_shift_filtered)
image_filtered = np.fft.ifft2(f_ishift).real  # –û–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ

# –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
plt.figure(figsize=(10, 5))
plt.subplot(1, 2, 1)
plt.imshow(image, cmap='gray')
plt.title('–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ')

plt.subplot(1, 2, 2)
plt.imshow(image_filtered, cmap='gray')
plt.title('–§–∏–ª—å—Ç—Ä –Ω–∏–∑–∫–∏—Ö —á–∞—Å—Ç–æ—Ç (—Ä–∞–∑–º—ã—Ç–∏–µ)')
plt.show()

üîπ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥?
–û—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∏–∑–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã (—Ä–∞–∑–º—ã—Ç–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ).
–£–±–∏—Ä–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ –∏ —à—É–º.
–ï—Å–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä –º–∞—Å–∫–∏ (mask[crow-50:crow+50, ccol-50:ccol+50]), —Ä–∞–∑–º—ã—Ç–∏–µ —Å—Ç–∞–Ω–µ—Ç —Å–∏–ª—å–Ω–µ–µ.


3. –§–∏–ª—å—Ç—Ä –≤—ã—Å–æ–∫–∏—Ö —á–∞—Å—Ç–æ—Ç (–ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–µ–º –¥–µ—Ç–∞–ª–∏)
–ï—Å–ª–∏ –≤–º–µ—Å—Ç–æ –Ω–∏–∑–∫–∏—Ö —á–∞—Å—Ç–æ—Ç –æ—Å—Ç–∞–≤–∏—Ç—å –≤—ã—Å–æ–∫–∏–µ, –º—ã –ø–æ–ª—É—á–∏–º —Ñ–∏–ª—å—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π —É—Å–∏–ª–∏–≤–∞–µ—Ç –∫—Ä–∞—è –∏ –∫–æ–Ω—Ç—É—Ä—ã.

# –°–æ–∑–¥–∞–µ–º –º–∞—Å–∫—É, –æ—Å—Ç–∞–≤–ª—è—é—â—É—é —Ç–æ–ª—å–∫–æ –≤—ã—Å–æ–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã
mask = np.ones((rows, cols), np.uint8)
mask[crow-30:crow+30, ccol-30:ccol+30] = 0  # –í—ã—Ä–µ–∑–∞–µ–º —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—É—é —á–∞—Å—Ç—å (–Ω–∏–∑–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã)

# –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∞—Å–∫—É
f_shift_filtered = f_shift * mask

# –û–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ
f_ishift = np.fft.ifftshift(f_shift_filtered)
image_filtered = np.fft.ifft2(f_ishift).real

# –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
plt.figure(figsize=(10, 5))
plt.subplot(1, 2, 1)
plt.imshow(image, cmap='gray')
plt.title('–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ')

plt.subplot(1, 2, 2)
plt.imshow(image_filtered, cmap='gray')
plt.title('–§–∏–ª—å—Ç—Ä –≤—ã—Å–æ–∫–∏—Ö —á–∞—Å—Ç–æ—Ç (—Ä–µ–∑–∫–æ—Å—Ç—å)')
plt.show()

üîπ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥?
–û—Å—Ç–∞–≤–ª—è–µ—Ç –≤—ã—Å–æ–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã (–¥–µ—Ç–∞–ª–∏ –∏ —Ç–µ–∫—Å—Ç—É—Ä—ã).
–£—Å–∏–ª–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç—É—Ä—ã –∏ –¥–µ–ª–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–æ–ª–µ–µ —Ä–µ–∑–∫–∏–º.


–ò—Ç–æ–≥–∏
‚úÖ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§—É—Ä—å–µ ‚Äì —ç—Ç–æ —Å–ø–æ—Å–æ–± "—Ä–∞–∑–æ–±—Ä–∞—Ç—å" –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ —á–∞—Å—Ç–æ—Ç—ã.
‚úÖ –ú—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —à—É–º–∞, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫—Ä–∞–µ–≤ –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç—É—Ä.
‚úÖ –í OpenCV –∏ NumPy —ç—Ç–æ –ª–µ–≥–∫–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é np.fft.fft2() –∏ np.fft.ifft2().

–ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ?
–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–∞ —Å–≤–æ–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö ‚Äì —Å–∫–∞—á–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –∏ –ø–æ—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å.
–ò–∑–º–µ–Ω—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ ‚Äì —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –∏ —É–º–µ–Ω—å—à–∞—Ç—å —Ä–∞–∑–º–µ—Ä –º–∞—Å–∫–∏.
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∑–∞–¥–∞—á–∞—Ö CV ‚Äì –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∑–∞–¥–∞—á–∞—Ö —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π.
